function checkUniqueEnroll(){var n=!0;return $("#firstiev").val()!=""&&($("#secondiev").val()!=""&&$("#firstiev").val()==$("#secondiev").val()&&(n=!1),$("#thirdiev").val()!=""&&$("#firstiev").val()==$("#thirdiev").val()&&(n=!1)),$("#secondiev").val()!=""&&$("#thirdiev").val()!=""&&$("#secondiev").val()==$("#thirdiev").val()&&(n=!1),n}function checkUniqueEnrollA(){var n=!0;return $("#afirstiev").val()!=""&&($("#asecondiev").val()!=""&&$("#afirstiev").val()==$("#asecondiev").val()&&(n=!1),$("#athirdiev").val()!=""&&$("#afirstiev").val()==$("#athirdiev").val()&&(n=!1)),$("#asecondiev").val()!=""&&$("#athirdiev").val()!=""&&$("#asecondiev").val()==$("#athirdiev").val()&&(n=!1),n}function loadMainPage(){$("#mainContent").fadeOut(200,function(){$.ajax({url:"login.html",cache:!1}).done(function(n){$("#mainContent").html(n);$("#mainContent").fadeIn(200);$("#refreshState").fadeOut(200);$(".tooltipped").tooltip({delay:50})}).fail(function(n,t,i){$("#refreshState").fadeOut(200);a.currentTime=0;a.play();Materialize.toast(n.status==404?"\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002":"\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: "+i,2e3)})})}function loadHelpPage(){$("#mainContent").fadeOut(200,function(){$.ajax({url:"help.html",cache:!1}).done(function(n){$("#mainContent").html(n);$("#mainContent").fadeIn(200);$("#refreshState").fadeOut(200);$(".collapsible").collapsible({accordion:!0})}).fail(function(n,t,i){$("#refreshState").fadeOut(200);a.currentTime=0;a.play();Materialize.toast(n.status==404?"\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002":"\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: "+i,2e3)})})}function loadAboutPage(){$("#mainContent").fadeOut(200,function(){$.ajax({url:"about.html",cache:!1}).done(function(n){$("#mainContent").html(n);$("#mainContent").fadeIn(200);$("#refreshState").fadeOut(200);$(".collapsible").collapsible({accordion:!0})}).fail(function(n,t,i){$("#refreshState").fadeOut(200);a.currentTime=0;a.play();Materialize.toast(n.status==404?"\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002":"\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: "+i,2e3)})})}function loadEventsPage(){$("#actionBar").css("box-shadow","rgba(0, 0, 0, 0.25) 0px 2px 1px 0px");$("#mainContent").fadeOut(200,function(){$.ajax({url:"events.html",cache:!1}).done(function(n){return $("#mainContent").html(n),$("#mainContent").fadeIn(200),$("#refreshState").fadeOut(200),$("#grade").material_select(),$("#eid").characterCounter(),$("ul.tabs").tabs(),$("#actionBar").css("box-shadow","none"),$(".tooltipped").tooltip({delay:50}),!0}).fail(function(n){return n.status==404?($("#refreshState").fadeOut(200),a.currentTime=0,a.play(),Materialize.toast("\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002",2e3)):n.status==403&&($("#refreshState").fadeOut(200),a.currentTime=0,a.play(),Materialize.toast("\u767b\u5165\u903e\u6642\u3002\u8acb\u91cd\u65b0\u767b\u5165\u3002",2e3),location.replace("#")),!1})})}function loadEntriesPage(){$("#actionBar").css("box-shadow","rgba(0, 0, 0, 0.25) 0px 2px 1px 0px");$("#mainContent").fadeOut(200,function(){$.ajax({url:"entries.html",cache:!1}).done(function(n){return $("#mainContent").html(n),$("#mainContent").fadeIn(200),$("#refreshState").fadeOut(200),$("#cls").material_select(),$(".tooltipped").tooltip({delay:50}),!0}).fail(function(n){return n.status==404?($("#refreshState").fadeOut(200),a.currentTime=0,a.play(),Materialize.toast("\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002",2e3)):n.status==403&&($("#refreshState").fadeOut(200),a.currentTime=0,a.play(),Materialize.toast("\u767b\u5165\u903e\u6642\u3002\u8acb\u91cd\u65b0\u767b\u5165\u3002",2e3),location.replace("#")),!1})})}function loadStatPage(){$("#actionBar").css("box-shadow","rgba(0, 0, 0, 0.25) 0px 2px 1px 0px");$("#mainContent").fadeOut(200,function(){$.ajax({url:"stat.html",cache:!1}).done(function(n){return $("#mainContent").html(n),$("#mainContent").fadeIn(200),$("#refreshState").fadeOut(200),!0}).fail(function(n){return n.status==404?($("#refreshState").fadeOut(200),a.currentTime=0,a.play(),Materialize.toast("\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002",2e3)):n.status==403&&($("#refreshState").fadeOut(200),a.currentTime=0,a.play(),Materialize.toast("\u767b\u5165\u903e\u6642\u3002\u8acb\u91cd\u65b0\u767b\u5165\u3002",2e3),location.replace("#")),!1})})}function loadEnrollPage(){$("#actionBar").css("box-shadow","rgba(0, 0, 0, 0.25) 0px 2px 1px 0px");$("#mainContent").fadeOut(200,function(){$.ajax({url:"enroll.html",cache:!1}).done(function(n){return $("#mainContent").html(n),$("#mainContent").fadeIn(200),$("#refreshState").fadeOut(200),$(".matsel").material_select(),$("ul.tabs").tabs(),$("#actionBar").css("box-shadow","none"),$(".tooltipped").tooltip({delay:50}),!0}).fail(function(n){return n.status==404?($("#refreshState").fadeOut(200),a.currentTime=0,a.play(),Materialize.toast("\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002",2e3)):n.status==403&&($("#refreshState").fadeOut(200),a.currentTime=0,a.play(),Materialize.toast("\u767b\u5165\u903e\u6642\u3002\u8acb\u91cd\u65b0\u767b\u5165\u3002",2e3),location.replace("#")),!1})})}function setActionBarTitle(n,t){$("#abMainTitle").text(n);$("#abSubTitle").text(t);t==""?($("#abMainTitle").animate({top:18},{queue:!1,duration:200}),$("#abSubTitle").fadeOut(200)):($("#abMainTitle").animate({top:6},{queue:!1,duration:200}),$("#abSubTitle").fadeIn(200))}function setBackButtonVisible(n){n?($("#backButton").css({left:0}),$("#abMainTitle").animate({left:58},{queue:!1,duration:175}),$("#abSubTitle").animate({left:58},{queue:!1,duration:175})):($("#backButton").css({left:-56}),$("#abMainTitle").animate({left:12},{queue:!1,duration:175}),$("#abSubTitle").animate({left:12},{queue:!1,duration:175}))}function tryCaptcha(n){captchaValue=n;console.log(n)}function captchaExp(){captchaValue="";b.currentTime=0;b.play();Materialize.toast("\u4eba\u6a5f\u9a57\u8b49\u5df2\u904e\u671f\uff0c\u8acb\u91cd\u65b0\u52fe\u9078 [\u6211\u4e0d\u662f\u81ea\u52d5\u7a0b\u5f0f] \u9078\u6846\u3002",2e3);console.log("captcha expired")}function checkLockPwd(){olocked?($("#validatinglockpwd").show(),$.ajax({url:"checklockpwd.html",data:{pwd:$("#lockpwdinp").val()},dataType:"json",method:"post",cache:!1}).done(function(n){$("#validatinglockpwd").hide();n.success==1?($("#modal6").closeModal(),$("#updateentry").click()):(c.currentTime=0,c.play(),$("#errortext").text("\u5bc6\u78bc\u932f\u8aa4\u3002"))})):$("#lockpwdinp").val()==""?(c.currentTime=0,c.play(),$("#errortext").text("\u9396\u5b9a\u5bc6\u78bc\u4e0d\u53ef\u70ba\u7a7a\u767d\u3002")):$("#lockpwdinp").val().length<6?(c.currentTime=0,c.play(),$("#errortext").text("\u9396\u5b9a\u5bc6\u78bc\u7684\u9577\u5ea6\u5fc5\u9808\u81f3\u5c11\u70ba 6\u3002")):($("#lockpwd").val($("#lockpwdinp").val()),$("#modal6").closeModal(),$("#updateentry").click())}function timerIncrement(){loggedin&&(idleTime++,idleTime>599?($("#modal7").closeModal(),idleWarningShown=!1,$("#refreshState").fadeIn(200),$.ajax({url:"logout.html",cache:!1}).done(function(){o.play();usertype="";captchaValue="";Materialize.toast("\u60a8\u5df2\u7d93\u767b\u51fa\u3002",2e3);loadMainPage()}).fail(function(n,t,i){$("#refreshState").fadeOut(200);Materialize.toast(n.status==404?"\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002":"\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: "+i,2e3);a.currentTime=0;a.play()}),$("#modal8").openModal({in_duration:200,out_duration:100})):idleTime>479&&(idleWarningShown||($("#modal7").openModal({in_duration:200,out_duration:100}),idleWarningShown=!0),$("#idlecount").text(600-idleTime)))}var usertype,recaptchaAvailable=!1,captchaValue,onloadCallback;location.hash="";var a=new Audio("err.wav"),b=new Audio("notice.wav"),c=new Audio("warn.wav"),i=new Audio("in.wav"),o=new Audio("out.wav"),olocked=!1,idleTime=0,idleWarningShown=!1,loggedin=!1;$(function(){var r=setInterval(timerIncrement,1e3),n,t;$(this).mousemove(function(){idleTime=0;idleWarningShown&&($("#modal7").closeModal(),idleWarningShown=!1)});$(this).keypress(function(){idleTime=0;idleWarningShown&&($("#modal7").closeModal(),idleWarningShown=!1)});$("#refreshState").show();$.ajax({url:"login.html",cache:!1}).done(function(n){$("#mainContent").html(n);$("#mainContent").fadeIn(200);$("#refreshState").fadeOut(200)});$("#menuButton").show();n="";$("#menuButton").dropdown({inDuration:150,outDuration:113,constrain_width:!1,hover:!1,gutter:0,belowOrigin:!1,alignment:"right"});is.ie()&&$("#modal4").openModal({in_duration:200,out_duration:100});t=$(".dropdown-content li *");setInterval(function(){t.addClass("waves-effect")},1e3);$(document).contextmenu(function(n){location.hash.replace("#","")!="help"&&location.hash.replace("#","")!="about"&&$("#menuButton").click();n.preventDefault()});$(window).on("hashchange",function(){is.ie()&&$("#modal4").openModal({in_duration:200,out_duration:100});$("#actionBar").css("box-shadow","rgba(0, 0, 0, 0.25) 0px 2px 1px 0px");var t=location.hash.replace("#","");t!=n&&($("#modal1").closeModal(),$("#modal2").closeModal(),$("#modal3").closeModal(),t==""?($("#menuButton").show(),$("#refButton").css("right",48),setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)",""),setBackButtonVisible(!1),$("#refreshState").fadeIn(200),n="",loadMainPage()):t=="help"?($("#menuButton").hide(),$("#refButton").css("right",8),setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)","\u8aaa\u660e"),setBackButtonVisible(!0),$("#refreshState").fadeIn(200),n="help",loadHelpPage()):t=="about"?($("#menuButton").hide(),$("#refButton").css("right",8),setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)","\u95dc\u65bc"),setBackButtonVisible(!0),$("#refreshState").fadeIn(200),n="about",loadAboutPage()):usertype!=undefined&&usertype!=""?($("#menuButton").show(),$("#refButton").css("right",48),t=="events"?usertype=="admin"?(setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)","\u7ba1\u7406\u9805\u76ee\u8cc7\u6599"),setBackButtonVisible(!0),$("#refreshState").fadeIn(200),n="events",loadEventsPage()):(Materialize.toast("\u60a8\u6c92\u6709\u700f\u89bd\u6b64\u9801\u9762\u7684\u6b0a\u9650\u3002",2e3),history.back(),c.currentTime=0,c.play()):t=="enroll"?(setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)","\u5831\u540d"),setBackButtonVisible(!0),$("#refreshState").fadeIn(200),n="enroll",loadEnrollPage()):t=="stat"?(setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)","\u5831\u540d\u7d71\u8a08"),setBackButtonVisible(!0),$("#refreshState").fadeIn(200),n="enroll",loadStatPage()):t=="entries"?usertype=="admin"||usertype=="helper"?(setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)","\u7ba1\u7406\u5831\u540d\u8cc7\u6599"),setBackButtonVisible(!0),$("#refreshState").fadeIn(200),n="entries",loadEntriesPage()):(Materialize.toast("\u60a8\u6c92\u6709\u700f\u89bd\u6b64\u9801\u9762\u7684\u6b0a\u9650\u3002",2e3),history.back(),c.currentTime=0,c.play()):(Materialize.toast("\u627e\u4e0d\u5230\u76f8\u7b26\u7684\u529f\u80fd\u3002",2e3),history.back(),c.currentTime=0,c.play())):(Materialize.toast("\u8acb\u767b\u5165\u5f8c\u518d\u9032\u884c\u6709\u95dc\u64cd\u4f5c\u3002",2e3),history.back(),c.currentTime=0,c.play()))});$("#refButton").click(function(){is.ie()&&$("#modal4").openModal({in_duration:200,out_duration:100});$("#actionBar").css("box-shadow","rgba(0, 0, 0, 0.25) 0px 2px 1px 0px");var t=location.hash.replace("#","");$("#modal1").closeModal();$("#modal2").closeModal();$("#modal3").closeModal();t==""?($("#menuButton").show(),$("#refButton").css("right",48),setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)",""),setBackButtonVisible(!1),$("#refreshState").fadeIn(200),n="",loadMainPage()):t=="help"?($("#menuButton").hide(),$("#refButton").css("right",8),setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)","\u8aaa\u660e"),setBackButtonVisible(!0),$("#refreshState").fadeIn(200),n="help",loadHelpPage()):t=="about"?($("#menuButton").hide(),$("#refButton").css("right",8),setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)","\u95dc\u65bc"),setBackButtonVisible(!0),$("#refreshState").fadeIn(200),n="about",loadAboutPage()):usertype!=undefined&&usertype!=""?($("#menuButton").show(),$("#refButton").css("right",48),t=="events"?usertype=="admin"?(setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)","\u7ba1\u7406\u9805\u76ee\u8cc7\u6599"),setBackButtonVisible(!0),$("#refreshState").fadeIn(200),n="events",loadEventsPage()):(Materialize.toast("\u60a8\u6c92\u6709\u700f\u89bd\u6b64\u9801\u9762\u7684\u6b0a\u9650\u3002",2e3),history.back(),c.currentTime=0,c.play()):t=="enroll"?(setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)","\u5831\u540d"),setBackButtonVisible(!0),$("#refreshState").fadeIn(200),n="enroll",loadEnrollPage()):t=="stat"?(setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)","\u5831\u540d\u7d71\u8a08"),setBackButtonVisible(!0),$("#refreshState").fadeIn(200),n="enroll",loadStatPage()):t=="entries"?usertype=="admin"||usertype=="helper"?(setActionBarTitle("\u6c34\u904b\u6703\u5831\u540d\u7cfb\u7d71 (\u6e2c\u8a66\u7248)","\u7ba1\u7406\u5831\u540d\u8cc7\u6599"),setBackButtonVisible(!0),$("#refreshState").fadeIn(200),n="entries",loadEntriesPage()):(Materialize.toast("\u60a8\u6c92\u6709\u700f\u89bd\u6b64\u9801\u9762\u7684\u6b0a\u9650\u3002",2e3),history.back(),c.currentTime=0,c.play()):(Materialize.toast("\u627e\u4e0d\u5230\u76f8\u7b26\u7684\u529f\u80fd\u3002",2e3),history.back(),c.currentTime=0,c.play())):(Materialize.toast("\u8acb\u767b\u5165\u5f8c\u518d\u9032\u884c\u6709\u95dc\u64cd\u4f5c\u3002",2e3),history.back(),c.currentTime=0,c.play())});$("#backButton").click(function(){history.back()});$(document).on("click","#cfull",function(){var n=document.getElementById("chart");n.requestFullscreen?n.requestFullscreen():n.msRequestFullscreen?n.msRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()});$(document).on("click","#addev",function(){$("#eid").val()==""||$("#ename").val()==""||$("#cname").val()==""?(c.currentTime=0,c.play(),Materialize.toast("\u8acb\u586b\u5beb\u6240\u6709\u6b04\u4f4d\u3002",2e3)):($("#refreshState").fadeIn(200),$.ajax({url:"handleEvent.html?method=post",data:{id:$("#eid").val(),grade:$("#grade").val(),ename:$("#ename").val(),cname:$("#cname").val(),type:$("#relay").prop("checked")?"R":"I"},dataType:"json",method:"post",cache:!1}).done(function(n){n.success==1?(Materialize.toast("\u5df2\u52a0\u5165\u9805\u76ee\u3002",2e3),loadEventsPage(),o.currentTime=0,o.play()):n.success==0?($("#refreshState").fadeOut(200),n.error.code==1062?(Materialize.toast("\u9805\u76ee\u91cd\u8907\uff0c\u8acb\u6aa2\u67e5\u8f38\u5165\u4e26\u91cd\u8a66\u3002",2e3),c.currentTime=0,c.play()):(Materialize.toast("\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: ("+n.error.code+")"+n.error.message,2e3),c.currentTime=0,c.play())):n.success==-2&&($("#refreshState").fadeOut(200),Materialize.toast("\u60a8\u6c92\u6709\u57f7\u884c\u6b64\u52d5\u4f5c\u7684\u6b0a\u9650\u3002",2e3),a.currentTime=0,a.play())}).fail(function(n,t,i){$("#refreshState").fadeOut(200);Materialize.toast(n.status==404?"\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002":"\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: "+i,2e3);c.currentTime=0;c.play()}))});$(document).on("click","#updateentry:not(.disabled)",function(){checkUniqueEnroll()?($("#updateentry").addClass("disabled"),$("#refreshState").fadeIn(200),$.ajax({url:"handleEnroll.html",data:{firstiev:$("#firstiev").val(),secondiev:$("#secondiev").val(),thirdiev:$("#thirdiev").val(),rev:$("#rev").val().join(),locked:$("#lockentry").prop("checked")?"1":"0",lockpwd:$("#lockpwd").val()},dataType:"json",method:"post",cache:!1}).done(function(n){$("#updateentry").removeClass("disabled");n.success==1?(Materialize.toast("\u5df2\u66f4\u65b0\u9805\u76ee\u3002",2e3),loadEnrollPage(),o.currentTime=0,o.play()):n.success==0&&($("#refreshState").fadeOut(200),Materialize.toast("\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: ("+n.error.code+")"+n.error.message,2e3),a.currentTime=0,a.play())}).fail(function(n,t,i){$("#updateentry").removeClass("disabled");$("#refreshState").fadeOut(200);Materialize.toast(n.status==404?"\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002":"\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: "+i,2e3);a.currentTime=0;a.play()})):($("#modal5").openModal({in_duration:200,out_duration:100}),c.currentTime=0,c.play())});$(document).on("change","#lockentry",function(){olocked?$("#lockentry").prop("checked")==!1&&($("#lockpwdinp").val(""),$("#errortext").text(""),$("#modal6").attr("data-mode","validate"),$("#modal6").openModal({dismissible:!1,in_duration:200,out_duration:100})):$("#lockentry").prop("checked")==!0?($("#lockpwdinp").val(""),$("#errortext").text(""),$("#modal6").attr("data-mode","create"),$("#modal6").openModal({dismissible:!1,in_duration:200,out_duration:100})):$("#lockpwd").val("")});$(document).on("click","#editent",function(){checkUniqueEnrollA()?($("#refreshState").fadeIn(200),$.ajax({url:"handleEnrollA.html",data:{firstiev:$("#afirstiev").val(),secondiev:$("#asecondiev").val(),thirdiev:$("#athirdiev").val(),rev:$("#rev").val().join(),id:$("#modal3").attr("data-id"),locked:$("#alockentry").prop("checked")?"1":"0"},dataType:"json",method:"post",cache:!1}).done(function(n){n.success==1?(Materialize.toast("\u5df2\u66f4\u65b0\u9805\u76ee\u3002",2e3),$("#refreshState").fadeOut(200),o.currentTime=0,o.play()):n.success==0&&($("#refreshState").fadeOut(200),Materialize.toast("\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: ("+n.error.code+")"+n.error.message,2e3),a.currentTime=0,a.play())}).fail(function(n,t,i){$("#refreshState").fadeOut(200);Materialize.toast(n.status==404?"\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002":"\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: "+i,2e3);a.currentTime=0;a.play()})):(Materialize.toast("\u9078\u53d6\u9805\u76ee\u91cd\u8907\u3002\u8acb\u6aa2\u67e5\u8f38\u5165\u4e26\u91cd\u8a66\u3002",2e3),c.currentTime=0,c.play())});$(document).on("click","#confirm:not(.disabled)",function(){$("#refreshState").fadeIn(200);$("#confirm").addClass("disabled");$("#u").prop("disabled",!0);$("#u").material_select();$("#p").prop("disabled",!0);$("#n").prop("disabled",!0);$.ajax({url:"handleLogin.html",data:{u:$("#u").val(),p:$("#p").val(),n:$("#n").val(),c:captchaValue},dataType:"json",method:"post",cache:!1}).done(function(n){typeof n=="string"?console.log(n):($("#confirm").removeClass("disabled"),$("#u").prop("disabled",!1),$("#u").material_select(),$("#p").prop("disabled",!1),$("#n").prop("disabled",!1),n.success==1?(usertype=n.type,Materialize.toast("\u767b\u5165\u6210\u529f\u3002\u6b63\u5728\u70ba\u60a8\u8f09\u5165\u4e3b\u9801\u9762...",2e3),loadMainPage(),i.play()):n.success==0?($("#refreshState").fadeOut(200),Materialize.toast("\u7528\u6236\u540d\u7a31\u6216\u5bc6\u78bc\u932f\u8aa4\u3002",2e3),c.currentTime=0,c.play()):n.success==-1?($("#refreshState").fadeOut(200),Materialize.toast("\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66\u3002",2e3),a.currentTime=0,a.play()):n.success==-2?($("#refreshState").fadeOut(200),Materialize.toast("\u8acb\u8f38\u5165\u7528\u6236\u540d\u7a31\u3001\u8f38\u5165\u5bc6\u78bc\u53ca\u5b8c\u6210\u4eba\u6a5f\u9a57\u8b49\u3002",2e3),b.currentTime=0,b.play()):n.success==-3?($("#refreshState").fadeOut(200),Materialize.toast("\u60a8\u7684\u5e33\u865f\u8cc7\u6599\u4ecd\u672a\u6e96\u5099\u597d\uff0c\u8acb\u7a0d\u5019\u518d\u8a66\u3002",2e3),c.currentTime=0,c.play()):n.success==-4&&($("#refreshState").fadeOut(200),Materialize.toast("\u4eba\u6a5f\u9a57\u8b49\u5931\u6557\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66\u3002",2e3),console.log(n.error),console.log(n.jsontext),c.currentTime=0,c.play()))}).fail(function(n,t,i){$("#confirm").removeClass("disabled");$("#u").prop("disabled",!1);$("#p").prop("disabled",!1);$("#refreshState").fadeOut(200);console.log(n.responseText);Materialize.toast(n.status==404?"\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002":"\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: "+i,2e3);a.currentTime=0;a.play()})});$(document).on("click","#logoutLink",function(){$("#refreshState").fadeIn(200);$.ajax({url:"logout.html",cache:!1}).done(function(){o.play();usertype="";captchaValue="";Materialize.toast("\u60a8\u5df2\u7d93\u767b\u51fa\u3002",2e3);loadMainPage()}).fail(function(n,t,i){$("#refreshState").fadeOut(200);Materialize.toast(n.status==404?"\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002":"\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: "+i,2e3);a.currentTime=0;a.play()})});$(document).on("click","#selent",function(){$("#refreshState").fadeIn(200);$.ajax({url:"editEntry.html",cache:!1,method:"post",data:{cls:$("#cls").val(),num:$("#num").val()}}).done(function(n){$("#entryDetails").html(n);$("#refreshState").fadeOut(200);$(".matsel").material_select();$("#modal3").openModal({in_duration:200,out_duration:100})})});$(document).on("change","#firstiev",function(){$(".matsel").material_select("destroy");$("#firstiev").val()==""?($("#firstiev").val($("#secondiev").val()),$("#secondiev").val($("#thirdiev").val()),$("#thirdiev").val(""),$("#firstiev").val()==""&&$("#secondiev").prop("disabled",!0),$("#secondiev").val()==""&&$("#thirdiev").prop("disabled",!0)):$("#secondiev").prop("disabled",!1);$(".matsel").material_select()});$(document).on("change","#secondiev",function(){$(".matsel").material_select("destroy");$("#secondiev").val()==""?($("#secondiev").val($("#thirdiev").val()),$("#thirdiev").val(""),$("#secondiev").val()==""&&$("#thirdiev").prop("disabled",!0)):$("#thirdiev").prop("disabled",!1);$(".matsel").material_select()});$(document).on("change","#afirstiev",function(){$(".matsel").material_select("destroy");$("#afirstiev").val()==""?($("#afirstiev").val($("#asecondiev").val()),$("#asecondiev").val($("#athirdiev").val()),$("#athirdiev").val(""),$("#afirstiev").val()==""&&$("#asecondiev").prop("disabled",!0),$("#asecondiev").val()==""&&$("#athirdiev").prop("disabled",!0)):$("#asecondiev").prop("disabled",!1);$(".matsel").material_select()});$(document).on("change","#asecondiev",function(){$(".matsel").material_select("destroy");$("#asecondiev").val()==""?($("#asecondiev").val($("#thirdiev").val()),$("#athirdiev").val(""),$("#asecondiev").val()==""&&$("#athirdiev").prop("disabled",!0)):$("#athirdiev").prop("disabled",!1);$(".matsel").material_select()});$(document).on("click",".delete-link",function(){$("#modal2").attr("data-id",$(this).attr("data-id"));$("#refreshState").fadeIn(200);$.ajax({url:"eventDetails.html",data:{id:$(this).attr("data-id")},dataType:"json",method:"post",cache:!1}).done(function(n){$("#eeid").removeClass("active");$("#eename").removeClass("active");$("#ecname").removeClass("active");$("#eeid").val(n.id);$("#egrade").val(n.grade);$("#eename").val(n.ename);$("#ecname").val(n.cname);$("#eeid").addClass("active");$("#eename").addClass("active");$("#ecname").addClass("active");$("#erelay").prop("checked",n.type=="R");$("#modal2").openModal({in_duration:200,out_duration:100});$("#refreshState").fadeOut(200);$("#egrade").material_select();$("#eeid").characterCounter()}).fail(function(n,t,i){$("#refreshState").fadeOut(200);a.currentTime=0;a.play();Materialize.toast(n.status==404?"\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002":"\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: "+i,2e3)})});$(document).on("click","#refEvents",function(){$("#refreshState").fadeIn(200);loadEventsPage()});$(document).on("click","#refEnroll",function(){$("#refreshState").fadeIn(200);loadEnrollPage()});$(document).on("click","#refStat",function(){$("#refreshState").fadeIn(200);loadStatPage()});$(document).on("click","#delev",function(){c.currentTime=0;c.play();$("#deleid").text($("#modal2").attr("data-id"));$("#modal1").attr("data-id",$("#modal2").attr("data-id"));$("#modal2").closeModal();$("#modal1").openModal({in_duration:200,out_duration:100})});$("#modal1 .no-btn").click(function(){$("#modal2").openModal({in_duration:200,out_duration:100})});$("#modal1 .yes-btn").click(function(){$("#refreshState").fadeIn(200);$.ajax({url:"handleEvent.html?method=delete",data:{id:$("#modal1").attr("data-id")},dataType:"json",method:"post",cache:!1}).done(function(n){n.success==1?(o.currentTime=0,o.play(),Materialize.toast("\u5df2\u522a\u9664\u9805\u76ee\u3002",2e3),loadEventsPage()):n.success==0?($("#refreshState").fadeOut(200),c.currentTime=0,c.play(),Materialize.toast("\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: ("+n.error.code+")"+n.error.message,2e3)):n.success==-2&&($("#refreshState").fadeOut(200),c.currentTime=0,c.play(),Materialize.toast("\u60a8\u6c92\u6709\u57f7\u884c\u6b64\u52d5\u4f5c\u7684\u6b0a\u9650\u3002",2e3))}).fail(function(n,t,i){$("#refreshState").fadeOut(200);a.currentTime=0;a.play();Materialize.toast(n.status==404?"\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002":"\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: "+i,2e3)})});$("#editev").click(function(){$("#refreshState").fadeIn(200);console.log($("#erelay").prop("checked")?"R":"I");$.ajax({url:"handleEvent.html?method=put",data:{id:$("#modal2").attr("data-id"),grade:$("#egrade").val(),ename:$("#eename").val(),cname:$("#ecname").val(),type:$("#erelay").prop("checked")?"R":"I"},dataType:"json",method:"post",cache:!1}).done(function(n){n.success==1?(o.currentTime=0,o.play(),console.log(n.q),Materialize.toast("\u5df2\u66f4\u65b0\u9805\u76ee\u3002",2e3),loadEventsPage()):n.success==0?($("#refreshState").fadeOut(200),c.currentTime=0,c.play(),Materialize.toast("\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: ("+n.error.code+")"+n.error.message,2e3)):n.success==-2&&($("#refreshState").fadeOut(200),c.currentTime=0,c.play(),Materialize.toast("\u60a8\u6c92\u6709\u57f7\u884c\u6b64\u52d5\u4f5c\u7684\u6b0a\u9650\u3002",2e3))}).fail(function(n,t,i){$("#refreshState").fadeOut(200);a.currentTime=0;a.play();Materialize.toast(n.status==404?"\u7db2l\u7d61\u932f\u8aa4\u3002\u8acb\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u9023\u7dda\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002":"\u767c\u751f\u4e0d\u660e\u7684\u932f\u8aa4\u3002\u8acb\u7a0d\u5019\u518d\u8a66: "+i,2e3)})})});captchaValue="";onloadCallback=function(){recaptchaAvailable=!0;recaptchacontainer&&grecaptcha.render(recaptchacontainer,{sitekey:"6LcbNxMTAAAAAJqw8rngqBFCofxVjUNdfzay7Rxj",callback:tryCaptcha,"expired-callback":captchaExp,type:"audio"})};