<?php
    session_start();
    if (isset($_SESSION['username'])) {
        if ($_SESSION['usertype'] == 'admin') {
            $mysqli = mysqli_connect('localhost', 'guest', '', 'swimminggala');
            mysqli_query($mysqli,"SET NAMES 'utf8'");
            if ($res = mysqli_query($mysqli,"select * from events order by id asc")) { ?>
<div>
    <ul class="tabs">
        <li class="tab waves-effect waves-light"><a class="active" href="#events-allitems">現有項目</a></li>
        <li class="tab waves-effect waves-light"><a href="#events-additem">新增項目</a></li>
    </ul>
</div>
        <div id="events-additem" style="padding-top: 48px;">
            <div>
                <div class="input-field">
                    <input id="eid" name="eid" type="text" length="9" maxlength="9" />
                    <label for="eid">項目編碼</label>
                </div>
                <div class="input-field">
                    <select name="grade" id="grade">
                        <option value="BA">男子甲組</option>
                        <option value="BB">男子乙組</option>
                        <option value="BC">男子丙組</option>
                        <option value="GA">女子甲組</option>
                        <option value="GB">女子乙組</option>
                        <option value="GC">女子丙組</option>
                    </select>
                    <label for="grade">組別</label>
                </div>
                <div class="input-field">
                    <input id="ename" name="ename" type="text" />
                    <label for="ename">英文名稱</label>
                </div>
                <div class="input-field">
                    <input id="cname" name="cname" type="text" />
                    <label for="cname">中文名稱</label>
                </div>
                <div class="switch">
                    接力項目
                    <label>
                        <input type="checkbox" id="relay" value="R">
                        <span class="lever"></span>
                    </label>
                </div><br />
                <a class="waves-effect waves-light btn" id="addev">加入</a>

            </div>
        </div>
        <div id="events-allitems" style="padding-top: 48px;">
<?php
            if (mysqli_num_rows($res) == 0) { ?>
            沒有項目。
<?php
            } else { ?>
            <ul class="collection" id="eventsCollection">
<?php
                while ($a = mysqli_fetch_assoc($res)) { ?>
                <li class="collection-item avatar" data-id="<?=$a['id']?>">
                    <i class="material-icons circle"><?php if ($a["type"] == "I") echo "person"; else echo "group"; ?></i>
                    <div class="title truncate tooltipped" data-position="bottom" data-delay="50" data-tooltip="<?=$a['ename']?> <?=$a['cname']?>"><?=$a['ename']?> <?=$a['cname']?></div>
                    <span>
                        項目編碼: <?=$a['id']?><br />
                        組別: <?php switch ($a['grade']) {
                case "GA":
                    echo "女子甲組";
                    break;
                case "GB":
                    echo "女子乙組";
                    break;
                case "GC":
                    echo "女子丙組";
                    break;
                case "BA":
                    echo "男子甲組";
                    break;
                case "BB":
                    echo "男子乙組";
                    break;
                case "BC":
                    echo "男子丙組";
                    break;
                case "N":
                    echo "未指定組別";
                    break;
            } ?><br />
                    </span>
                    <a class="secondary-content delete-link waves-effect" data-id="<?=$a['id']?>"><i class="material-icons">edit</i></a>
                </li>
<?php
                }
?>
            </ul>
<?php
            }
?>
</div>

<?php
            }
        } else {
            header("HTTP/1.1 403 Forbidden");
        }
    } else {
        header("HTTP/1.1 403 Forbidden");
    }
?>